# Maintainer: J.F.Gratton <jean-francois@famillegratton.net>
# Packager: Package builder <builder@famillegratton.net>
pkgname=dtools2
pkgver=0.40.00
pkgrel=0
pkgdir=/data/packages
builddir="$startdir/src/BUILD"
pkgdesc="docker/podman client"
url="https://git.famillegratton.net:3000/devops/dtools2.git"
arch=x86_64
license=GPL2
depends=""
install=""
makedepends="go"
options="!check"
#source="$pkgname-$pkgver-$pkgrel.tar.bz2::http://localhost/$pkgname-$pkgver-$pkgrel.tar.bz2"
binaryname=dtools2

prepare() {
	mkdir -p "$builddir"
	cp -R "$startdir"/../src/* "$builddir"/
}

build() {
	cd "$builddir"

	# Static, non-PIE, internal linker
	go build -trimpath -ldflags="-s -w -buildid= -linkmode=internal" -o "$binaryname" .
}

package() {
	install -d "$pkgdir"/opt/bin
	install "$builddir/$binaryname" "$pkgdir/opt/bin/$binaryname"
}

